<app-search-bar-search></app-search-bar-search>
<div class="search-results mb-4" *ngIf="searchResults.length > 0">
  <table class="dark-table">
    <thead>
      <tr>
        <th scope="col">Datoteka</th>
        <th scope="col">Uploader</th>
        <th scope="col">Velikost</th>
        <th scope="col">SE</th>
        <th scope="col">LE</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let torrent of searchResults">
        <tr 
          (click)="toggleRow(torrent)" 
          *ngIf="!torrent.expanded" 
          title="{{torrent.title}}"
        >
          <td>
            <div class="d-flex align-items-center">
              <img *ngIf="torrent.source === 'Native'" src="assets/images/TODO.png" alt="{{ torrent.title }} Image" width="50" class="mr-2">
              <img *ngIf="torrent.source === 'None'" src="assets/images/no-image.png" alt="{{ torrent.title }} Image" width="50" class="mr-2 p-2">
              <img *ngIf="torrent.source === 'thePirateBay'" src="assets/images/tpb.png" alt="{{ torrent.title }} Image" width="50" class="mr-2">
              <img *ngIf="torrent.source === '_1337x'" src="assets/images/1337x.png" alt="{{ torrent.title }} Image" width="50" class="mr-2">
              <img *ngIf="torrent.source === 'yts'" src="assets/images/yts.png" alt="{{ torrent.title }} Image" width="50" class="mr-2">
              <div>
                <h4>{{ torrent.title }}</h4>
                <p *ngIf="torrent.source === 'Native'">
                  {{ torrent.category }} | {{ torrent.format }} | {{ torrent.year }}
                </p>
              </div>
            </div>
          </td>
          <td>{{ torrent.source }}</td>
          <td>{{ torrent.size }}</td>
          <td>{{ torrent.seeds }}</td>
          <td>{{ torrent.leechers || '/' }}</td>
        </tr>
  
        <tr
          (click)="toggleRow(torrent)" 
          *ngIf="torrent.expanded" 
          title="{{torrent.title}}"
        >
          <td colspan="5" style="margin: 0; padding: 0;">
            <div class="expanded-info">
              <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center w-100">
                  <img *ngIf="torrent.source === 'Native'" src="assets/images/TODO.png" alt="{{ torrent.title }} Image" width="100" class="mr-3">
                  <img *ngIf="torrent.source === 'None'" src="assets/images/no-image.png" alt="{{ torrent.title }} Image" width="100" class="mr-3 p-2">
                  <img *ngIf="torrent.source === 'thePirateBay'" src="assets/images/tpb.png" alt="{{ torrent.title }} Image" width="100" class="mr-3">
                  <img *ngIf="torrent.source === '_1337x'" src="assets/images/1337x.png" alt="{{ torrent.title }} Image" width="100" class="mr-3">
                  <img *ngIf="torrent.source === 'yts'" src="assets/images/yts.png" alt="{{ torrent.title }} Image" width="100" class="mr-3">
                  <div class="w-100">
                    <h4>{{ torrent.title }}</h4>
                    <div class="d-flex justify-content-between align-items-center">
                      <div class="expanded-details-container d-flex justify-content-between align-items-center">
                        <div class="expanded-details">
                          <p>Velikost</p>
                          <p>{{ torrent.size }}</p>
                        </div>
                        <div class="expanded-details">
                          <p>Seeders</p>
                          <p>{{ torrent.seeds }}</p>
                        </div>
                        <div class="expanded-details">
                          <p>Leechers</p>
                          <p>{{ torrent.leechers || '/' }}</p>
                        </div>
                        <div class="expanded-details">
                          <p>Nalo≈æeno</p>
                          <p>{{ torrent.time | date:'d.M.y' }}</p>
                        </div>
                      </div>
  
                      <div class="buttons-container">
                        <button #copyButton class="action-button copy-button" title="Kopiraj magnet link" (click)="copy($event, copyButton, torrent.url)">
                          <img src="assets/images/copy.png" alt="Kopiraj magnet link">
                          <p>{{ copyText }}</p>
                        </button>
                        <button #downloadButton class="action-button download-button" title="Potegni ga!" (click)="download($event, torrent.url)">
                          <img src="assets/images/download-green.png" alt="Potegni ga!" >
                          <p>{{ downloadText }}</p>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>
</div>


<div class="loading-spinner mb-4" *ngIf="displayLoadingSpinner">
  <app-loading-spinner></app-loading-spinner>
</div>

<div class="no-results mb-4" *ngIf="noResults">
  <h3>
    Ni rezultatov :(
  </h3>
</div>